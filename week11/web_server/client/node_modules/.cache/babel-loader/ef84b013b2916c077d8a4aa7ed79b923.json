{"ast":null,"code":"import _classCallCheck from \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/src/NewsPanel/NewsPanel.js\";\nimport './NewsPanel.css';\nimport React from 'react';\nimport NewsCard from '../NewsCard/NewsCard';\nimport _ from 'lodash';\n\nvar NewsPanel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NewsPanel, _React$Component);\n\n  function NewsPanel() {\n    var _this;\n\n    _classCallCheck(this, NewsPanel);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewsPanel).call(this));\n    _this.state = {\n      news: null\n    };\n    return _this;\n  }\n\n  _createClass(NewsPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.loadMoreNews();\n      this.loadMoreNews = _.debounce(this.loadMoreNews, 1000);\n      window.addEventListener('scroll', function () {\n        return _this2.handleScroll();\n      });\n    }\n  }, {\n    key: \"handleScroll\",\n    value: function handleScroll() {\n      var scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n\n      if (window.innerHeight + scrollY >= document.body.offsetHeight - 50) {\n        console.log('Locading more news...');\n        this.loadMoreNews();\n      }\n    }\n  }, {\n    key: \"loadMoreNews\",\n    value: function loadMoreNews() {\n      var _this3 = this;\n\n      console.log('Actually triggered loading more news');\n      var news_url = 'http://' + window.location.hostname + ':3000' + '/news';\n      var request = new Request(news_url, {\n        method: 'GET'\n      });\n      fetch(request).then(function (res) {\n        return res.json();\n      }).then(function (news_list) {\n        _this3.setState({\n          news: _this3.state.news ? _this3.state.news.concat(news_list) : news_list\n        });\n      });\n    }\n  }, {\n    key: \"renderNews\",\n    value: function renderNews() {\n      var news_list = this.state.news.map(function (one_news) {\n        return React.createElement(\"a\", {\n          className: \"list-group-item\",\n          href: \"#\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 44\n          },\n          __self: this\n        }, React.createElement(NewsCard, {\n          news: one_news,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 45\n          },\n          __self: this\n        }));\n      });\n      return React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"list-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, news_list));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!this.state.news) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 62\n          },\n          __self: this\n        }, \"Loading...\");\n      } else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68\n          },\n          __self: this\n        }, this.renderNews());\n      }\n    }\n  }]);\n\n  return NewsPanel;\n}(React.Component);\n\nexport default NewsPanel;","map":{"version":3,"sources":["/Users/yangfolder/Documents/WashU18f/CS503-1805_Yang_Wu/week10/tap-news/src/NewsPanel/NewsPanel.js"],"names":["React","NewsCard","_","NewsPanel","state","news","loadMoreNews","debounce","window","addEventListener","handleScroll","scrollY","pageYOffset","document","documentElement","scrollTop","innerHeight","body","offsetHeight","console","log","news_url","location","hostname","request","Request","method","fetch","then","res","json","news_list","setState","concat","map","one_news","renderNews","Component"],"mappings":";;;;;;AAAA,OAAO,iBAAP;AAEA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,OAAOC,CAAP,MAAc,QAAd;;IAEMC,S;;;;;AACJ,uBAAc;AAAA;;AAAA;;AACZ;AACA,UAAKC,KAAL,GAAa;AAACC,MAAAA,IAAI,EAAC;AAAN,KAAb;AAFY;AAGb;;;;wCAEmB;AAAA;;AAClB,WAAKC,YAAL;AACA,WAAKA,YAAL,GAAoBJ,CAAC,CAACK,QAAF,CAAW,KAAKD,YAAhB,EAA8B,IAA9B,CAApB;AACAE,MAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC;AAAA,eAAM,MAAI,CAACC,YAAL,EAAN;AAAA,OAAlC;AACD;;;mCAEc;AACb,UAAIC,OAAO,GAAGH,MAAM,CAACG,OAAP,IAAkBH,MAAM,CAACI,WAAzB,IAAwCC,QAAQ,CAACC,eAAT,CAAyBC,SAA/E;;AACA,UAAKP,MAAM,CAACQ,WAAP,GAAqBL,OAAtB,IAAmCE,QAAQ,CAACI,IAAT,CAAcC,YAAd,GAA6B,EAApE,EAAyE;AACvEC,QAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACA,aAAKd,YAAL;AACD;AACF;;;mCAEc;AAAA;;AACba,MAAAA,OAAO,CAACC,GAAR,CAAY,sCAAZ;AACA,UAAMC,QAAQ,GAAG,YAAYb,MAAM,CAACc,QAAP,CAAgBC,QAA5B,GAAuC,OAAvC,GAAiD,OAAlE;AACA,UAAMC,OAAO,GAAG,IAAIC,OAAJ,CAAYJ,QAAZ,EAAsB;AAAEK,QAAAA,MAAM,EAAE;AAAV,OAAtB,CAAhB;AAEAC,MAAAA,KAAK,CAACH,OAAD,CAAL,CACGI,IADH,CACQ,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OADX,EAEGF,IAFH,CAEQ,UAAAG,SAAS,EAAI;AACjB,QAAA,MAAI,CAACC,QAAL,CAAc;AACZ3B,UAAAA,IAAI,EAAE,MAAI,CAACD,KAAL,CAAWC,IAAX,GAAkB,MAAI,CAACD,KAAL,CAAWC,IAAX,CAAgB4B,MAAhB,CAAuBF,SAAvB,CAAlB,GAAsDA;AADhD,SAAd;AAGD,OANH;AAOD;;;iCAEY;AACX,UAAMA,SAAS,GAAG,KAAK3B,KAAL,CAAWC,IAAX,CAAgB6B,GAAhB,CAAoB,UAAAC,QAAQ,EAAI;AAChD,eACE;AAAG,UAAA,SAAS,EAAC,iBAAb;AAA+B,UAAA,IAAI,EAAC,GAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,QAAD;AAAU,UAAA,IAAI,EAAEA,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,CADF;AAKD,OANiB,CAAlB;AAQA,aACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGJ,SADH,CADF,CADF;AAOD;;;6BAEQ;AACP,UAAI,CAAC,KAAK3B,KAAL,CAAWC,IAAhB,EAAsB;AACpB,eACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF;AAKD,OAND,MAMO;AACL,eACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACG,KAAK+B,UAAL,EADH,CADF;AAKD;AACF;;;;EAlEqBpC,KAAK,CAACqC,S;;AAqE9B,eAAelC,SAAf","sourcesContent":["import './NewsPanel.css';\n\nimport React from 'react';\nimport NewsCard from '../NewsCard/NewsCard';\nimport _ from 'lodash';\n\nclass NewsPanel extends React.Component {\n  constructor() {\n    super();\n    this.state = {news:null};\n  }\n\n  componentDidMount() {\n    this.loadMoreNews();\n    this.loadMoreNews = _.debounce(this.loadMoreNews, 1000);\n    window.addEventListener('scroll', () => this.handleScroll());\n  }\n\n  handleScroll() {\n    let scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n    if ((window.innerHeight + scrollY) >= (document.body.offsetHeight - 50)) {\n      console.log('Locading more news...');\n      this.loadMoreNews();\n    }\n  }\n\n  loadMoreNews() {\n    console.log('Actually triggered loading more news');\n    const news_url = 'http://' + window.location.hostname + ':3000' + '/news';\n    const request = new Request(news_url, { method: 'GET' });\n\n    fetch(request)\n      .then(res => res.json())\n      .then(news_list => {\n        this.setState({\n          news: this.state.news ? this.state.news.concat(news_list) : news_list,\n        });\n      })\n  }\n\n  renderNews() {\n    const news_list = this.state.news.map(one_news => {\n      return (\n        <a className='list-group-item' href='#'>\n          <NewsCard news={one_news} />\n        </a>\n      );\n    });\n\n    return (\n      <div className='container-fluid'>\n        <div className='list-group'>\n          {news_list}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.state.news) {\n      return (\n        <div>\n          Loading...\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          {this.renderNews()}\n        </div>\n      );\n    }\n  }\n}\n\nexport default NewsPanel;"]},"metadata":{},"sourceType":"module"}